# 中继器和预言机

本文档解释了 Zama 协议的服务接口——中继器和预言机。

## 什么是预言机？

预言机是一种链外服务，代表智能合约从 FHEVM 协议检索解密值。

虽然 FHEVM 协议的核心组件处理加密、计算和密钥管理，但预言机和中继器提供用户、智能合约和链外基础设施之间的必要连接。它们充当与网关交互的轻量级服务，实现与加密值的顺畅交互——而不需要用户或合约处理复杂的集成逻辑。

这些组件不是协议的可信基础的一部分；它们的行为是完全可验证的，它们的不当行为不会损害机密性或正确性。

## 预言机的职责

- 监听来自合约的链上解密请求。
- 代表合约将解密请求转发到网关。
- 等待 KMS 通过网关生成签名的明文。
- 回调主机链上的合约，传递解密的结果。

由于解密的值由 KMS 签名，接收的智能合约可以验证结果，从而无需\
信任预言机本身。

## 预言机的安全模型

- 预言机是**不受信任的**：它们只能延迟请求，不能伪造它。
- 所有结果都经过签名并可以在链上验证。

如果一个预言机无法响应，另一个可以接管。

目标：使合约能够异步安全地访问解密值，而无需嵌入解密逻辑。

## 什么是中继器？

中继器是一种面向用户的服务，简化了与网关的交互，特别是对于需要在链外进行的加密和\
解密操作。

## 中继器的职责

- 将用户的加密输入发送到网关进行注册。
- 启动用户端解密请求，包括 EIP-712 身份验证。
- 从 KMS 收集响应，在用户的公钥下重新加密。
- 将密文传递回用户，用户在浏览器/应用程序中本地解密。

这允许用户与加密智能合约交互，而无需运行自己的网关接口、\
验证器或 FHE 工具。

## 中继器的安全模型

- 中继器是无状态的且**不受信任的**。
- 所有数据流都经过签名，用户可以审计。
- 用户可以随时运行自己的中继器或直接与网关交互。

目标：让用户轻松提交加密输入并检索私密解密结果，而无需管理\
基础设施。

## 它们如何适配

- 智能合约使用预言机通过回调接收加密计算的明文结果。
- 用户依靠中继器将加密值推送到系统中并获取个人解密结果，所有这些都由\
  EIP-712 签名和 FHE 密钥重新加密支持。

预言机和中继器共同帮助弥合加密执行和应用程序可用性之间的差距——而不会损害安全性或去中心化。
